//  **Text Toggle**
//
//  https://github.com/jsvine/text-toggle
//
//  Author: Jeremy Singer-Vine
//  
//  Based on a script originally published on Slate Magazine (slate.com). Licensed under the MIT license.
//
//  ***
//
(function(a){var b=function(b){var d,e,f;this.$el=b.constructor===a?b:a(b),e=this._getDelinses(this.$el),d=this._zipDelinses(e),this.pairs=a.map(d,a.proxy(function(a){return new c(a[0],a[1],this)},this)),this.parent=b.delins?b.delins.pair.parent:null,this.parent||this._activateToggling()};b.prototype={reset:function(){this.$el.find("del").removeClass("text_toggle_off"),this.$el.find("ins").addClass("text_toggle_off")},translate:function(){this.$el.find("del").addClass("text_toggle_off"),this.$el.find("ins").removeClass("text_toggle_off")},_activateToggling:function(){this.$el.on("click",".text_toggle",function(a){this.delins.$el.toggleClass("text_toggle_off"),this.delins.getSibling().$el.toggleClass("text_toggle_off"),a.stopPropagation()})},_getDelinses:function(){var a="del:not(ins:not(.text_toggle) del):not(del:not(.text_toggle) del)",b="ins:not(ins:not(.text_toggle) ins):not(del:not(.text_toggle) ins)";return{dels:this.$el.find(a),inses:this.$el.find(b)}},_zipDelinses:function(a){if(a.inses.length!==a.dels.length)throw new Error("Each TextToggle must have the same number of <ins>es and <del>s.");var b=a.inses.length,c=new Array(b);for(var d=0;d<b;d++)c[d]=[a.dels[d],a.inses[d]];return c}};var c=function(a,b,c){this.parent=c,this.del=new d(a,this),this.ins=new d(b,this)},d=function(c,d){this.el=c,this.$el=a(c),this.tag=c.tagName,this.el.delins=this,this.tag.toLowerCase()==="ins"&&this.$el.addClass("text_toggle_off"),this.$el.addClass("text_toggle"),this.pair=d,this.children=new b(this.el),this.children.pairs.length||delete this.children};d.prototype.getSibling=function(){return this.tag.toLowerCase()==="del"?this.pair.ins:this.pair.del},b.fromJSON=function(c){var d,e,f;return d=a("<div>"),e=function(b,c){return b.constructor===Array?c?"<del>"+e(b[0])+"</del>"+"<ins>"+e(b[1])+"</ins>":a.map(b,function(a,b){return e(a,!0)}).join(""):b},f=e(c),d.html(f),new b(d)},this.TextToggle=b})(jQuery);